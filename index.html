<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Análise Fatorial: Variáveis</title>
		
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
	<!--Zoom Home-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>

    <link rel="stylesheet" href="style.css">
	
	<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
            integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
            crossorigin=""></script>
		
	<!-- Load Leaflet from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" crossorigin=""></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@^3.0.8/dist/esri-leaflet.js"></script>
    <script src="https://unpkg.com/esri-leaflet-vector@3.1.3/dist/esri-leaflet-vector.js"></script>
	
	<!-- Vector Tiles -->
<script src="https://unpkg.com/esri-leaflet-vector@3.1.3/dist/esri-leaflet-vector.js"
    integrity="sha512-2sbebld2cAnzUw4nloopGcKE7AGl7xUlCXg8amUWS47veGTKMH6tx1VsT7U9ukwXPAVzecigXK0jMtS5UcllDg=="
    crossorigin=""></script>

<script src="https://unpkg.com/esri-leaflet@1.0.5"></script>
	
	
	 <!--Zoom Home-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>

    <link rel="stylesheet" href="style.css">

    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
            integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
            crossorigin=""></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
            integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
            crossorigin="anonymous"></script>
	<script src="https://unpkg.com/esri-leaflet@2.5.1/dist/esri-leaflet.js"
			integrity="sha512-q7X96AASUF0hol5Ih7AeZpRF6smJS55lcvy+GLWzJfZN+31/BQ8cgNx2FGF+IQSA4z2jHwB20vml+drmooqzzQ=="
			crossorigin=""></script>
 
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.4/html2canvas.min.js"></script>
  
  <link rel="stylesheet" href="style.css" type="text/css" media="print"/>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script type = "text/javascript" scr ="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
   <script type = "text/javascript" scr ="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>

	 <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        #map {
            min-height: 100%;
        }


        .info {
            padding: 6px 8px;
            line-height: 18px;
            background: white;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }

		
        /* --- Zoom Home --- */
        .leaflet-bar a {
            background-color: #fff;
            border-bottom: 1px solid #ccc;
            color: #000000;
            display: block;
            height: 26px;
            width: 26px;
            line-height: 1.45 !important;
            text-align: center;
            text-decoration: none;
            font: bold 18px monospace;
        }

        #range-slider {
            width: 1000px;
        }

        .legend {
            text-align: left;
            line-height: 20px;
            color: #000000;
        }

        .legend i {
            width: 19px;
            height: 20px;
            float: left;
            margin-right: 10px;
            opacity: 1;
        }

        #info {
            margin: 10px;
            position: absolute;
            top: 0px;
            right: 0px;
            width: 400px;
            height: 45px;
            overflow-y: auto;
            max-height: 400px;
            background-color: #fff;
            z-index: 999;
        }
		.popup {
		text-align: center;
		}
		
		.btnGeojson {
		    background-color: #fff;
			border: none;
			border-radius: 10%;
			border-width: 2px;
			boder-opacity:0.4;
			color: black;
			padding:7px 7px;
			font-size: 17px;
			position: fixed;
			top:100px;
			left: 11px;
			margin-top: 8px;
			z-index:999;
			box-shadow: 0 2px 2px 0 rgba(0,0,0,0.2), 0 2px 2px 0 rgba(0,0,0,0.19);
			cursor: pointer;
			position: absolute;
			}

		.btnPNG {
			border: none;
			border-radius: 10%;
			border-width: 2px;
			boder-opacity:0.4;
			color: black;
			padding:7px 7px;
			font-size: 17px;
			position: fixed;
			top:137px;
			left: 11px;
			margin-top: 8px;
			z-index:999;
			box-shadow: 0 2px 2px 0 rgba(0,0,0,0.2), 0 2px 2px 0 rgba(0,0,0,0.19);
			cursor: pointer;
			background: white;
			position: absolute;
			}	
			
/* Darker background on mouse-over */
.btnGeojson:hover {
  background-color: #f2f2f2;
}

.btnPNG:hover {
  background-color: #f2f2f2;
}

.leaflet-top.leaflet-right .leaflet-control-layers:nth-child(1) .leaflet-control-layers-toggle {
 background-image: url(https://uxwing.com/wp-content/themes/uxwing/download/31-location-travel-map/maps.png) !important;
	background-color: white;
  background-size: 30px 30px;
}

.leaflet-top.leaflet-right .leaflet-control-layers:nth-child(2) .leaflet-control-layers-toggle {
 background-image: url(https://cdn2.iconfinder.com/data/icons/mobile-web-app-vol-5-1/32/Stack_Layer_file_data-512.png) !important;
	background-color: white;
  background-size: 30px 30px;
}
 
 </style>
</head>
<body>
		<div id="map">
		<a href="./AnaliseFatorial_Variaveis.geojson" download>
		<button title="Dowload do ficheiro GeoJson" class="btnGeojson"><i class="fa fa-file-o"></i></button>
		</a>
		<button title =" Cique para obter o mapa" id="save"class="btnPNG" ><i class="fa fa-file-image-o"></i></button>	
		</div>	
		<script>
		
		var map = L.map('map', {
			zoomControl: false,
			center: [39.5, -7],
			//zoom:5,
			//maxZoom: 12,
			minZoom: 3,
			maxZoom: 19,
			maxBounds: extensao,
			preferCanvas: true,
		});
		
		var sudoeste = L.latLng(25, -34),
			nordeste = L.latLng(45.3, 5),
			extensao = L.latLngBounds(sudoeste, nordeste);

    var lat = 39.5; // __________Zoom Home
    var lng = -7// __________Zoom Home
    var zoom = 6.8; // __________Zoom Home
    var globalTimestamp = "2";

    map.setView([lat, lng], zoom); // __________Zoom Home

		var layer = L.esri.basemapLayer('Topographic').addTo(map);
	
	L.Control.zoomHome = L.Control.extend({
        options: {
            position: 'topleft',
            zoomInText: '+',
            zoomInTitle: 'Zoom in',
            zoomOutText: '-',
            zoomOutTitle: 'Zoom out',
            zoomHomeText: '<i class="fa fa-home" style="line-height:1.65;"></i>',
            zoomHomeTitle: 'Zoom home'
        },

        onAdd: function (map) {
            var controlName = 'gin-control-zoom',
                container = L.DomUtil.create('div', controlName + ' leaflet-bar'),
                options = this.options;

            this._zoomInButton = this._createButton(options.zoomInText, options.zoomInTitle,
                controlName + '-in', container, this._zoomIn);
            this._zoomHomeButton = this._createButton(options.zoomHomeText, options.zoomHomeTitle,
                controlName + '-home', container, this._zoomHome);
            this._zoomOutButton = this._createButton(options.zoomOutText, options.zoomOutTitle,
                controlName + '-out', container, this._zoomOut);

            this._updateDisabled();
            map.on('zoomend zoomlevelschange', this._updateDisabled, this);

            return container;
        },

        onRemove: function (map) {
            map.off('zoomend zoomlevelschange', this._updateDisabled, this);
        },

        _zoomIn: function (e) {
            this._map.zoomIn(e.shiftKey ? 3 : 1);
        },

        _zoomOut: function (e) {
            this._map.zoomOut(e.shiftKey ? 3 : 1);
        },

        _zoomHome: function (e) {
            map.setView([lat, lng], zoom);
        },

        _createButton: function (html, title, className, container, fn) {
            var link = L.DomUtil.create('a', className, container);
            link.innerHTML = html;
            link.href = '#';
            link.title = title;

            L.DomEvent.on(link, 'mousedown dblclick', L.DomEvent.stopPropagation)
                .on(link, 'click', L.DomEvent.stop)
                .on(link, 'click', fn, this)
                .on(link, 'click', this._refocusOnMap, this);

            return link;
        },
		
		_updateDisabled: function () {
            var map = this._map,
                className = 'leaflet-disabled';

            L.DomUtil.removeClass(this._zoomInButton, className);
            L.DomUtil.removeClass(this._zoomOutButton, className);

            if (map._zoom === map.getMinZoom()) {
                L.DomUtil.addClass(this._zoomOutButton, className);
            }
            if (map._zoom === map.getMaxZoom()) {
                L.DomUtil.addClass(this._zoomInButton, className);
            }
        }
    });
var Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'}).addTo(map);
	
	var Esri_WorldStreetMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012'
});

var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});

var Esri_WorldGrayCanvas = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
	maxZoom: 16
});

var CartoDB_VoyagerNoLabels = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20
});

var baseMaps ={
	"WorldTopoMap": Esri_WorldTopoMap, 
	"WorldStreetMap": Esri_WorldStreetMap, 
	"WorldImagery": Esri_WorldImagery,
	"WorldGrayCanvas": Esri_WorldGrayCanvas,
	"CartoDB": CartoDB_VoyagerNoLabels
	};

var layerControl = L.control.layers(baseMaps).addTo(map);

document.getElementById("save").addEventListener("click", function() {
    
    html2canvas(document.querySelector('#map'),{
	allowTaint:true,
	useCORS: true, 
	removeContainer: false,
	useOverflow: false,
	scale:0.8,
	windowWidth: 1200,
	windowHeight:1000,
	}).then(function(canvas) {
    saveAs(canvas.toDataURL(), 'AnaliseFatorialVariaveis.png');
    });
});
function saveAs(uri, filename) {
    var link = document.createElement('a');
    if (typeof link.download === 'string') {
        link.href = uri;
        link.download = filename;
        //Firefox requires the link to be in the body
        document.body.appendChild(link);
        //simulate click
        link.click();
        //remove the link when done
        document.body.removeChild(link);
    } else {
        window.open(uri);
    }
}		

//DEFINIR SIMBOLOGIA//

function limites_style(feature) {
return {
fillColor: limites_color(feature.properties.AreaEstudo),
color: limites_color(feature.properties.AreaEstudo),
weight: 2,
fillOpacity: 0.6
};
}
function limites_color(p) {
if (p === "Aveiro") return "#98E500"; else
if (p === "Coimbra") return "#DF9E66"; else
if (p === "Faro") return "#FDAA01"; else
if (p === "Área Metropolitana de Lisboa") return "#49CFD2"; else
return "grey";
}
var Limites_legend = L.control({position: 'bottomright'});
Limites_legend.onAdd = function (map) {
 var div = L.DomUtil.create('div', 'legend');
    categories = ['Área Metropolitana de Lisboa', 'Aveiro', 'Coimbra', 'Faro'];
	
	div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>Área de Estudo:</b><br><span>  <span class="brsmall"></span>  ';
	
    for (var i = 0; i < categories.length; i++) {
        div.innerHTML +=
        '<i style="background:' + limites_color(categories[i]) + '"></i> ' +
         (categories[i] ? categories[i] + '<br>' : '+');
    }
    return div;
        };

        Limites_legend.addTo(map);

function dp_style(feature) {
return {
fillColor: dp_color(feature.properties.DP),
color: dp_color(feature.properties.DP),
weight: 2,
fillOpacity: 0.6
};
}
function dp_color(d) {
return d > 10000 ? '#7F2704':
d > 5000 ? '#B73C02' :
d > 1000 ? '#E95E0D' :
d > 500 ? '#FD8D3C' :
d > 250? '#FDB97D' :
d > 100 ? '#FEDFBF' :
'#FFF5EB';
    }

function DurMedMovi_style(feature) {
return {
fillColor: DurMedMovi_color(feature.properties.DurMedMovi),
color: DurMedMovi_color(feature.properties.DurMedMovi),
weight: 2,
fillOpacity: 0.6
};
}
function DurMedMovi_color(d) {
return d > 27 ? '#E64C00' :
d > 24 ? '#FFAA00' :
d > 21? '#FFEBAF' :
d > 17? '#80CDC1' :
'#018571';
    }
	
function EncarMedMensal_style(feature) {
return {
fillColor: EncarMedMensal_color(feature.properties.EncarMedMe),
color: EncarMedMensal_color(feature.properties.EncarMedMe),
weight: 2,
fillOpacity: 0.6
};
}
function EncarMedMensal_color(d) {
return d > 550 ? '#081D58' :
d > 450 ? '#206FB0' :
d > 350 ? '#6AC5BE' :
'#EDF8B1';
    }
	
function IE_style(feature) {
return {
fillColor: IE_color(feature.properties.IE),
color: IE_color(feature.properties.IE),
weight: 2,
fillOpacity: 0.6
};
}
function IE_color(d) {
return d > 204 ? '#7B3700' :
d > 154 ? '#9C6430' :
d > 125 ? '#BD915F' :
d > 95 ? '#DEBE8E' :
'#FFEBBE';
    }

function NPisos_style(feature) {
return {
fillColor: NPisos_color(feature.properties.NPisos),
color: NPisos_color(feature.properties.NPisos),
weight: 2,
fillOpacity: 0.6
};
}
function NPisos_color(d) {
return d > 6 ? '#A50F15' :
d > 4 ? '#DE2D26' :
d > 2 ? '#FCAE91' :
'#FEE5D9';
    }
	
function PopC1Difi_style(feature) {
return {
fillColor: PopC1Difi_color(feature.properties.PopC1Difi),
color: PopC1Difi_color(feature.properties.PopC1Difi),
weight: 2,
fillOpacity: 0.6
};
}
function PopC1Difi_color(d) {
return d > 22 ? '#852D90' :
d > 19 ? '#8C74B5' :
d > 17 ? '#9AB4D6' :
d > 15 ? '#CCDDEC' :
'#F7FCFD';
    }

function PopEstrang_style(feature) {
return {
fillColor: PopEstrang_color(feature.properties.PopEstrang),
color: PopEstrang_color(feature.properties.PopEstrang),
weight: 2,
fillOpacity: 0.6
};
}
function PopEstrang_color(d) {
return d > 8.9 ? '#00204D' :
d > 5.5 ? '#414D6C' :
d > 3.5 ? '#7D7C79' :
d > 1.5 ? '#BEAF6F' :
'#FFEB46';
    }
	
function AlojArrenS_style(feature) {
return {
fillColor: AlojArrenS_color(feature.properties.AlojArrenS),
color: AlojArrenS_color(feature.properties.AlojArrenS),
weight: 2,
fillOpacity: 0.6
};
}
function AlojArrenS_color(d) {
return d > 56 ? '#444F89' :
d > 36 ? '#737B96' :
d > 22 ? '#A2A7A4' :
d > 11 ? '#D0D3B1' :
'#FFFFBE';
    }
	
function AlojS1Infr_style(feature) {
return {
fillColor: AlojS1Infr_color(feature.properties.AlojS1Infr),
color: AlojS1Infr_color(feature.properties.AlojS1Infr),
weight: 2,
fillOpacity: 0.6
};
}
function AlojS1Infr_color(d) {
return d > 2.3 ?' #E69800':
d > 1.4 ? '#EEBA3F' :
d > 0.7 ? '#F7DD7F' :
'#FFFFBE';
    }
	
	
function EdifMtDegr_style(feature) {
return {
fillColor: EdifMtDegr_color(feature.properties.EdifMtDegr),
color: EdifMtDegr_color(feature.properties.EdifMtDegr),
weight: 2,
fillOpacity: 0.6
};
}
function EdifMtDegr_color(d) {
return d > 2.4 ?' #9F4100':
d > 1.3 ? '#BF7A3A' :
d > 0.6 ? '#DFB275' :
'#FFEBAF';
    }


function FamUni65ma_style(feature) {
return {
fillColor:FamUni65ma_color(feature.properties.FamUni65ma),
color: FamUni65ma_color(feature.properties.FamUni65ma),
weight: 2,
fillOpacity: 0.6
};
}
function FamUni65ma_color(d) {
return d > 12.9 ?' #446589':
d > 10.1 ? '#80B1AF' :
d > 7.8 ? '#BEDEC1' :
'#FFEBBE';
    }

function CasaisCFil_style(feature) {
return {
fillColor:CasaisCFil_color(feature.properties.CasaisCFil),
color: CasaisCFil_color(feature.properties.CasaisCFil),
weight: 2,
fillOpacity: 0.6
};
}
function CasaisCFil_color(d) {
return d > 59.5 ?' #E64C00':
d > 54.4 ? '#F7C34D' :
d > 51.3 ? '#FFFF8C' :
'#FFFFBE';
    }

function ProfSocMai_style(feature) {
return {
fillColor:ProfSocMai_color(feature.properties.ProfSocMai),
color: ProfSocMai_color(feature.properties.ProfSocMai),
weight: 2,
fillOpacity: 0.6
};
}
function ProfSocMai_color(d) {
return d > 32.1 ?' #002673':
d > 23 ?' #567A6C':
d > 18.1 ? '#ABCD66' :
d > 14.3 ? '#D5E692' :
'#FFFFBE';
    }


function UtilizAuto_style(feature) {
return {
fillColor: UtilizAuto_color(feature.properties.UtilizAuto),
color: UtilizAuto_color(feature.properties.UtilizAuto),
weight: 2,
fillOpacity: 0.6
};
}
function UtilizAuto_color(d) {
return d > 73.5 ?' #343434':
d > 67.9 ?' #676256':
d > 60 ? '#9A9079' :
d > 45.7 ? '#CCBD9C' :
'#FFEBBE';
    }

function TxAtivid_style(feature) {
return {
fillColor: TxAtivid_color(feature.properties.TxAtivid),
color: TxAtivid_color(feature.properties.TxAtivid),
weight: 2,
fillOpacity: 0.6
};
}
function TxAtivid_color(d) {
return d > 50.7 ?' #006D2C':
d > 48.5 ? '#2CA25F' :
d > 45.8 ? '#B2E2E2' :
'#EDF8FB';
    }

function TxAnalf_style(feature) {
return {
fillColor: TxAnalf_color(feature.properties.TxAnalf),
color: TxAnalf_color(feature.properties.TxAnalf),
weight: 2,
fillOpacity: 0.6
};
}
function TxAnalf_color(d) {
return d > 7 ?' #73004C':
d > 4.3 ? '#A22842' :
d > 3 ? '#D08167' :
'#FFEBBE';
    }

function TxDesempr_style(feature) {
return {
fillColor: TxDesempr_color(feature.properties.TxDesempr),
color: TxDesempr_color(feature.properties.TxDesempr),
weight: 2,
fillOpacity: 0.6
};
}
function TxDesempr_color(d) {
return d > 13.8 ?' #A80000':
d > 11.3 ? '#C55331' :
d > 9.6? '#E2A570' :
'#FFEBBE';
    }


function ValorMedRe_style(feature) {
return {
fillColor: ValorMedRe_color(feature.properties.ValorMedRe),
color: ValorMedRe_color(feature.properties.ValorMedRe),
weight: 2,
fillOpacity: 0.6
};
}
function ValorMedRe_color(d) {
return d > 318.7 ?' #004C73':
d > 253.2 ? '#4D88A2' :
d > 188.1? '#9AC3D0' :
'#E8FFFF';
    }

function IDI_style(feature) {
return {
fillColor: IDI_color(feature.properties.IDI),
color: IDI_color(feature.properties.IDI),
weight: 2,
fillOpacity: 0.6
};
}
function IDI_color(d) {
return d > 39.1 ?' #A87000':
d > 32.8 ?' #BE9430':
d > 27.9 ? '#D4B85F' :
d > 23.1? '#E9DB8E' :
'#FFFFBE';
    }

function IL_style(feature) {
return {
fillColor: IL_color(feature.properties.IL),
color: IL_color(feature.properties.IL),
weight: 2,
fillOpacity: 0.6
};
}
function IL_color(d) {
return d > 50.9 ?' #004C73':
d > 46.8 ? '#448299' :
d > 42.9? '#89B7BF' :
'#CDEDE4';
    }


//ADICIONAR CAMADAS//

fetch("./AnaliseFatorial_Variaveis.geojson")
.then(function(response){ return response.json() })
.then(function(data){

var LimitesAE = L.geoJSON(data, {
style: limites_style
}).addTo(map);

var DP = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Densidade Populacional: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.DP + ' hab./km<sup>2</sup>'+'<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: dp_style,
  });

var DPlegend = L.control({position: 'bottomright'});
DPlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [ 8, 100, 250, 500,1000, 5000,10000],
                labels = [ '[8 - 100]',']100 - 250]',']250 - 500]', ']500 - 1 000]',']1 000 - 5 000]' ,']5 000 - 10 000]',']10 000 - 29 495]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>hab./km<sup>2</sup><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + dp_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var DurMedMovi = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Duração média dos movimentos pendulates: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.DurMedMovi + ' mins.'+'<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: DurMedMovi_style,
  });

var DurMedMovilegend = L.control({position: 'bottomright'});
DurMedMovilegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [ 0, 17, 21, 24,27],
                labels = [ '[12,9 - 17]' ,']17 - 21]',']21 - 24]',']24 - 27]', ']27 - 35,2]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>mins.<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + DurMedMovi_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var EncarMedMe = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Encargos médios mensais por aquisição de habitação própria: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.EncarMedMe + ' €'+'<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: EncarMedMensal_style,
  });
  var EncarMedMelegend = L.control({position: 'bottomright'});
EncarMedMelegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 350, 450, 550],
                labels = ['[251,9 - 350' ,']350 - 450]',']450 - 550]',']550 - 643,2]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>€<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + EncarMedMensal_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var IE = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Índice de Envelhecimento: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.IE + ' %'+'<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: IE_style,
  });
  var IElegend = L.control({position: 'bottomright'});
IElegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 95, 125, 154,204],
                labels = [ '[15,5 - 95]' ,']95 - 125]',']125 - 154]',']154 - 204]',']204 - 597,2]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + IE_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };
		
var NPisos = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Número de pisos por edifício: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.NPisos + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: NPisos_style,
  });
  var NPisoslegend = L.control({position: 'bottomright'});
NPisoslegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,2,4,6],
                labels = [ '[1 - 2]',']2 - 4]',']4 - 6]',']6 - 7,6]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>nº<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + NPisos_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var PopC1Difi = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. da pop. residente com pelo menos 1 dificuldade: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.PopC1Difi + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: PopC1Difi_style,
  });
  var PopC1Difilegend = L.control({position: 'bottomright'});
PopC1Difilegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,15,17,19, 22],
                labels = [ '[6 - 15]',']15 - 17]',']17 - 19]',']19 - 22]', ']22 - 36,9]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + PopC1Difi_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };


var PopEstrang = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. da pop. residente de nacionalidade estrangeira: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.PopEstrang + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: PopEstrang_style,
  });
  var PopEstranglegend = L.control({position: 'bottomright'});
PopEstranglegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,1.5,3.5,5.5, 8.9],
                labels = [ '[0 - 1,5]',']1,5 - 3,5]',']3,5 - 5,5]',']5,5 - 8,9]', ']8,9 - 34,8]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + PopEstrang_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var AlojArrenS = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de aloj. familiares clássicos arrendados/subarrendados: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AlojArrenS + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: AlojArrenS_style,
  });
  var AlojArrenSlegend = L.control({position: 'bottomright'});
AlojArrenSlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,11,22,36, 56],
                labels = [ '[0 - 11]',']11 - 22]',']22 - 36]',']36 - 56]', ']56 - 83,6]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + AlojArrenS_color(grades[i] + 1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var AlojS1Infr = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de aloj. familiares clássicos sem pelo menos uma infraestrutura básica: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AlojS1Infr + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: AlojS1Infr_style,
  });
  var AlojS1Infrlegend = L.control({position: 'bottomright'});
AlojS1Infrlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,0.7,1.4,2.3] ,
                labels = [ '[0 - 0,7]',']0,7 - 1,4]',']1,4 - 2,3]', ']2,3 - 12,2]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + AlojS1Infr_color(grades[i]+0.7) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var EdifMtDegr = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de edifícios muito degradados: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.EdifMtDegr + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: EdifMtDegr_style,
  });
  var EdifMtDegrlegend = L.control({position: 'bottomright'});
EdifMtDegrlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,0.6,1.3,2.4] ,
                labels = [ '[0 - 0,6]',']0,6 - 1,3]',']1,3 - 2,4]', ']2,4 - 43,5]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + EdifMtDegr_color(grades[i]+0.6) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

		
var FamUni65ma = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de famílias clássicas unipessoais de pessoas com 65 ou mais anos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.FamUni65ma + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: FamUni65ma_style,
  });
  var FamUni65malegend = L.control({position: 'bottomright'});
FamUni65malegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,7.8,10.1,12.9] ,
                labels = [ '[2,1 - 7,8]',']7,8 - 10,1]',']10,1 - 12,9]', ']12,9 - 27,4]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + FamUni65ma_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };


var CasaisCFil = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de núcleos familiares de casais com filhos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.CasaisCFil + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: CasaisCFil_style,
  });
  var CasaisCFillegend = L.control({position: 'bottomright'});
CasaisCFillegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,51.3,54.4,59.5] ,
                labels = [ '[35,2 - 51,3]',']51,3 - 54,4]',']54,4 - 59,5]', ']59,5 - 73]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + CasaisCFil_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var ProfSocMai = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de profissionais socialmente mais valorizadas: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.ProfSocMai + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: ProfSocMai_style,
  });
  var ProfSocMailegend = L.control({position: 'bottomright'});
ProfSocMailegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,14.3,18.1,23,32.1] ,
                labels = [ '[6,7 - 14,3]',']14,3 - 18,1]',']18,1 - 23]', ']23 - 32,1]', ']32,1 - 64,9]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + ProfSocMai_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };


var UtilizAuto = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Prop. de utilização de automóvel nas deslocações: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.UtilizAuto + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: UtilizAuto_style,
  });
  var UtilizAutolegend = L.control({position: 'bottomright'});
UtilizAutolegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,47.7,60,67.9,73.5] ,
                labels = [ '[12,9 - 45,7]',']45,7 - 60]',']60 - 67,9]', ']67,9 - 73,5]', ']73,5 - 86,5]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + UtilizAuto_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };
		
var TxAtivid = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Taxa de atividade da população residente: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.TxAtivid + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: TxAtivid_style,
  });
  var TxAtividlegend = L.control({position: 'bottomright'});
TxAtividlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,45.8,48.5,50.7] ,
                labels = [ '[36,4 - 45,8]',']45,8 - 48,5]',']48,5 - 50,7]', ']50,7 - 64,9]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + TxAtivid_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var TxAnalf = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Taxa de analfabetismo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.TxAnalf + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: TxAnalf_style,
  });
  var TxAnalflegend = L.control({position: 'bottomright'});
TxAnalflegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,3,4.3,7] ,
                labels = [ '[0,8 - 3]',']3 - 4,3]',']4,3 - 7]', ']7- 24,5]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + TxAnalf_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };


var TxDesempr = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Taxa de desemprego: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.TxDesempr + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: TxDesempr_style,
  });
  var TxDesemprlegend = L.control({position: 'bottomright'});
TxDesemprlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,9.6,11.3,13.8] ,
                labels = [ '[4,6 - 9,6]',']9,6 - 11,3]',']11,3 - 13,8]', ']13,8 - 27,6]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + TxDesempr_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var ValorMedRe = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Valor médio mensal das rendas dos aloj. familiares clássicos arrendados: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.ValorMedRe + ' €'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: ValorMedRe_style,
  });
  var ValorMedRelegend = L.control({position: 'bottomright'});
ValorMedRelegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,188.1,253.2,318.7] ,
                labels = [ '[0 - 188,1]',']188,1 - 253,2]',']253,2 - 318,7]', ']318,7 - 439,7]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + ValorMedRe_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };


var IDI = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Índice de dependência de idosos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.IDI + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: IDI_style,
  });
  var IDIlegend = L.control({position: 'bottomright'});
IDIlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,23.1,27.9,32.8,39.1] ,
                labels = [ '[5,4 - 23,1]',']23,1 - 27,9]',']27,9 - 32,8]', ']32,8 - 39,1]',']39,1 - 70,9]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + IDI_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

var IL = L.geoJson(data, { 
onEachFeature: function(feature, layer) {
layer.bindPopup(
'<div  <span style = "text-align: center; font-weight:bold; color:black;font-size:13px">'+feature.properties.FREGUESIAS +'</span>' + '<br>'+ '</div>' +
'<div <span style="text-align: left; font-weight:bold; color:black; font-size:11px;">Índice de Longevidade: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.IL + ' %'+ '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Área de Estudo: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+ feature.properties.AreaEstudo + '<br>' +
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Código da Coroa: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.COROA_COD + '<br>'+ 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Nº do Cluster: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.N_Clustert + '</div>' + 
'<span style="text-align: left; font-weight:bold; color:black; font-size:11px;"> Aplicação de Inquéritos: </span>'+ '<span style = "text-align: left;font-weight:normal; color:black; ">'+feature.properties.AplicacaoI + '</div>' + 
'<div <span style="text-align:right; font-weight:bold; color:black; font-size:8px;">  Freguesias de 2011 </span>' +'</div>');
	},
	style: IL_style,
  });
  var ILlegend = L.control({position: 'bottomright'});
ILlegend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0,42.9,46.8,50.9] ,
                labels = [ '[24,5 - 42,9]',']42,9 - 46,8]',']46,8 - 50,9]', ']50,9 - 66,2]'],
                from, to;

			div.innerHTML = '<FONT SIZE=2 style = "font-family:verdana"><b>%<b><br><span>  <span class="brsmall"></span>  '; // Títulos da legenda
			
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + IL_color(grades[i]+1) + '"></i>' +
                    labels[i] + (grades[i + 1] ? '  '
                    + '<br>' : ' <br> <span SIZE=1>' +
                    '<span style = "font-weight:normal; style = "font-family:verdana"; color:black"</span>' +
                    '<FONT SIZE=1 style = "font-family:verdana">Fonte dos dados: <a href="https://www.ine.pt/xportal/xmain?xpgid=ine_main&xpid=INE" target="_blank">INE</a>')

            }
            return div;
        };

 //ADICIONAR TROCA DE LAYERS//
	var baseMaps = {
    "Áreas de Estudo": LimitesAE,
    "Densidade Populacional": DP,
    "Duração média dos movimentos pendulares <br> da pop. residente empregada/estudante": DurMedMovi,
	"Encargos médios mensais <br> por aquisição de habitação prórpia": EncarMedMe,
	"Índice Envelhecimento": IE,
	"Pisos por edifício": NPisos,
	"Proporção da pop. residente com pelo menos uma dificuldade": PopC1Difi,
	"Proporção da pop. residente de nacionalidade estrangeira": PopEstrang,
	"Proporção de aloj. familiares clássicos arrendados ou subarrendados": AlojArrenS,
	"Proporção de aloj. familiares clássicos <br> sem pelo menos uma infraestrutura": AlojS1Infr,
	"Proporção de edifícios muito degradados": EdifMtDegr,
	"Proporção de famílias clássicas unipessoais <br> de pessoas com 65 ou mais anos": FamUni65ma,
	"Proporção de núcleos familiares de casais com filhos": CasaisCFil,
	"Proporção de profissionais socialmente mais valorizadas": ProfSocMai,	
	"Proporção de utilização do automóvel nas deslocações": UtilizAuto,	
	"Taxa de atividade da população residente": TxAtivid,	
	"Taxa de analfabetismo": TxAnalf,
	"Taxa de desemprego": TxDesempr,
	"Valor médio mensal das rendas dos <br> aloj. familiares clássicos arrendados": ValorMedRe,	
	"Índice de dependência de idosos": IDI,
	"Índice de Longevidade": IL,	
};

var overlayMaps = {};

L.control.layers(baseMaps, overlayMaps, {
    collapsed:true,
    position:'topright',
}).addTo(map);

currentLegend = Limites_legend;

map.on('baselayerchange', function (eventLayer) {
    if (eventLayer.name === 'Áreas de Estudo') {
        map.removeControl(currentLegend );
        currentLegend = Limites_legend;
        Limites_legend.addTo(map);
    }
    else if  (eventLayer.name === 'Densidade Populacional') {
        map.removeControl(currentLegend );
        currentLegend = DPlegend;
        DPlegend.addTo(map);
    }
    else if  (eventLayer.name === 'Duração média dos movimentos pendulares <br> da pop. residente empregada/estudante') {
        map.removeControl(currentLegend );
        currentLegend = DurMedMovilegend;
        DurMedMovilegend.addTo(map);
    }
	 else if  (eventLayer.name === 'Encargos médios mensais <br> por aquisição de habitação prórpia') {
        map.removeControl(currentLegend );
        currentLegend = EncarMedMelegend;
        EncarMedMelegend.addTo(map);
 
	}
	else if  (eventLayer.name === 'Índice Envelhecimento') {
        map.removeControl(currentLegend );
        currentLegend = IElegend;
        IElegend.addTo(map);
    }
	else if  (eventLayer.name === 'Pisos por edifício') {
        map.removeControl(currentLegend );
        currentLegend = NPisoslegend;
        NPisoslegend.addTo(map);
    }
	else if  (eventLayer.name === 'Proporção da pop. residente com pelo menos uma dificuldade') {
        map.removeControl(currentLegend );
        currentLegend = PopC1Difilegend;
        PopC1Difilegend.addTo(map);
		}
	else if  (eventLayer.name === 'Proporção da pop. residente de nacionalidade estrangeira') {
        map.removeControl(currentLegend );
        currentLegend = PopEstranglegend;
        PopEstranglegend.addTo(map);
    }
	else if  (eventLayer.name === 'Proporção de aloj. familiares clássicos arrendados ou subarrendados') {
        map.removeControl(currentLegend );
        currentLegend = AlojArrenSlegend;
        AlojArrenSlegend.addTo(map);
    }	
	else if  (eventLayer.name === 'Proporção de aloj. familiares clássicos <br> sem pelo menos uma infraestrutura') {
        map.removeControl(currentLegend );
        currentLegend = AlojS1Infrlegend;
        AlojS1Infrlegend.addTo(map);
    }	
	else if  (eventLayer.name === 'Proporção de edifícios muito degradados') {
        map.removeControl(currentLegend );
        currentLegend = EdifMtDegrlegend;
        EdifMtDegrlegend.addTo(map);
    }
	else if  (eventLayer.name === 'Proporção de famílias clássicas unipessoais <br> de pessoas com 65 ou mais anos') {
        map.removeControl(currentLegend );
        currentLegend = FamUni65malegend;
        FamUni65malegend.addTo(map);
    }	
	else if  (eventLayer.name === 'Proporção de núcleos familiares de casais com filhos') {
        map.removeControl(currentLegend );
        currentLegend = CasaisCFillegend;
        CasaisCFillegend.addTo(map);
    }	
	else if  (eventLayer.name === 'Proporção de profissionais socialmente mais valorizadas') {
        map.removeControl(currentLegend );
        currentLegend = ProfSocMailegend;
        ProfSocMailegend.addTo(map);
    }
	else if  (eventLayer.name === 'Proporção de utilização do automóvel nas deslocações') {
        map.removeControl(currentLegend );
        currentLegend = UtilizAutolegend;
        UtilizAutolegend.addTo(map);
    }
	else if  (eventLayer.name === 'Taxa de atividade da população residente') {
        map.removeControl(currentLegend );
        currentLegend = TxAtividlegend;
        TxAtividlegend.addTo(map);
    }
	else if  (eventLayer.name === 'Taxa de analfabetismo') {
        map.removeControl(currentLegend );
        currentLegend = TxAnalflegend;
        TxAnalflegend.addTo(map);
    }
	else if  (eventLayer.name === 'Taxa de desemprego') {
        map.removeControl(currentLegend );
        currentLegend = TxDesemprlegend;
        TxDesemprlegend.addTo(map);
    }
	else if  (eventLayer.name === 'Valor médio mensal das rendas dos <br> aloj. familiares clássicos arrendados') {
        map.removeControl(currentLegend );
        currentLegend = ValorMedRelegend;
        ValorMedRelegend.addTo(map);
    }
	else if  (eventLayer.name === 'Índice de dependência de idosos') {
        map.removeControl(currentLegend );
        currentLegend = IDIlegend;
        IDIlegend.addTo(map);
    }
	else if  (eventLayer.name === 'Índice de Longevidade') {
        map.removeControl(currentLegend );
        currentLegend = ILlegend;
        ILlegend.addTo(map);
    }
  });
    });

$.getJSON("./CAOP_Github_geo.geojson", function(data) {
L.geoJSON(data, {
style: {
color: "black",
weight: 0.5,
fillColor: "gray",
fillOpacity: 0.2
}
}).addTo(map);
}); 
 // Creating scale control
    var scale = L.control.scale();
    scale.addTo(map);

    // Creating Zoom Home
    var zoomHome = new L.Control.zoomHome();
    zoomHome.addTo(map);
               
    </script>
</body>
</html>